<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>マツエの携帯</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@200;300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/phone.css">
    <link rel="stylesheet" href="css/apps/player.css">
    <link rel="stylesheet" href="css/apps/messages.css">
    <link rel="stylesheet" href="css/apps/diary.css">
    <link rel="stylesheet" href="css/apps/memo.css">
    <link rel="stylesheet" href="css/apps/browser.css">
    <link rel="stylesheet" href="css/apps/calendar.css">
</head>
<body>
    <div class="phone-container">
        <div class="phone-frame">
            <!-- 壁纸 -->
            <div class="wallpaper">
                <!-- 闪烁星星 -->
                <div class="stars">
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                    <div class="star"></div>
                </div>
            </div>

            <!-- 状态栏 -->
            <div class="status-bar">
                <span class="time" id="status-time">12:00</span>
                <div class="status-icons">
                    <svg class="icon-signal" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="2" y="14" width="3" height="8" rx="1"/>
                        <rect x="7" y="10" width="3" height="12" rx="1"/>
                        <rect x="12" y="6" width="3" height="16" rx="1"/>
                        <rect x="17" y="2" width="3" height="20" rx="1"/>
                    </svg>
                    <svg class="icon-wifi" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 18c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm-4.9-2.3l1.4 1.4C9.4 16.4 10.6 16 12 16s2.6.4 3.5 1.1l1.4-1.4C15.6 14.6 13.9 14 12 14s-3.6.6-4.9 1.7zm-2.8-2.8l1.4 1.4C7.3 13 9.5 12 12 12s4.7 1 6.3 2.3l1.4-1.4C17.7 11.1 15 10 12 10s-5.7 1.1-7.7 2.9z"/>
                    </svg>
                    <svg class="icon-battery" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="2" y="6" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
                        <rect x="4" y="8" width="12" height="8" rx="1"/>
                        <rect x="20" y="9" width="2" height="6" rx="1"/>
                    </svg>
                </div>
            </div>

            <!-- 主屏幕 -->
            <div class="home-screen active" id="home-screen">
                <!-- 日期显示 -->
                <div class="date-display">
                    <div class="date-main">11月25日</div>
                    <div class="date-sub">2022年 土曜日</div>
                    <!-- 诗句 -->
                    <div class="quote">
                        <p>何にも考えずに広い空を見上げてると</p>
                        <p>自分の悩んでることがなんだかちっぽけに思えてきて</p>
                    </div>
                </div>

                <div class="app-grid">
                    <!-- 播放器：戴耳机的黑猫头 -->
                    <div class="app-icon" data-app="player">
                        <div class="cat-icon">
                            <svg viewBox="0 0 60 60" fill="#1a1520">
                                <!-- 猫头轮廓 -->
                                <path d="M30 52 C12 52 4 40 4 28 C4 20 8 14 12 10 L18 2 L24 14 C26 13.5 28 13.2 30 13.2 C32 13.2 34 13.5 36 14 L42 2 L48 10 C52 14 56 20 56 28 C56 40 48 52 30 52 Z"/>
                                <!-- 左耳内 -->
                                <path d="M14 12 L18 6 L21 14 Z" fill="#f5d4c8"/>
                                <!-- 右耳内 -->
                                <path d="M46 12 L42 6 L39 14 Z" fill="#f5d4c8"/>
                                <!-- 左眼白 -->
                                <ellipse cx="20" cy="30" rx="8" ry="9" fill="white"/>
                                <!-- 右眼白 -->
                                <ellipse cx="40" cy="30" rx="8" ry="9" fill="white"/>
                                <!-- 左眼珠 -->
                                <circle cx="22" cy="31" r="5" fill="#1a1520"/>
                                <!-- 右眼珠 -->
                                <circle cx="42" cy="31" r="5" fill="#1a1520"/>
                                <!-- 眼睛高光 -->
                                <circle cx="19" cy="28" r="2" fill="white"/>
                                <circle cx="39" cy="28" r="2" fill="white"/>
                                <!-- 耳机 -->
                                <path d="M4 24 Q0 16 10 12" stroke="#e8945a" stroke-width="3" fill="none" stroke-linecap="round"/>
                                <path d="M56 24 Q60 16 50 12" stroke="#e8945a" stroke-width="3" fill="none" stroke-linecap="round"/>
                                <circle cx="4" cy="26" r="5" fill="#e8945a"/>
                                <circle cx="56" cy="26" r="5" fill="#e8945a"/>
                            </svg>
                        </div>
                        <span class="app-name">プレイヤー</span>
                    </div>

                    <!-- 消息：眯眼笑的黑猫头+气泡 -->
                    <div class="app-icon" data-app="messages">
                        <div class="cat-icon">
                            <svg viewBox="0 0 60 60" fill="#1a1520">
                                <!-- 猫头轮廓 -->
                                <path d="M30 52 C12 52 4 40 4 28 C4 20 8 14 12 10 L18 2 L24 14 C26 13.5 28 13.2 30 13.2 C32 13.2 34 13.5 36 14 L42 2 L48 10 C52 14 56 20 56 28 C56 40 48 52 30 52 Z"/>
                                <!-- 左耳内 -->
                                <path d="M14 12 L18 6 L21 14 Z" fill="#e8d0e0"/>
                                <!-- 右耳内 -->
                                <path d="M46 12 L42 6 L39 14 Z" fill="#e8d0e0"/>
                                <!-- 眯眯眼 - 开心 -->
                                <path d="M12 30 Q20 24 28 30" stroke="white" stroke-width="4" fill="none" stroke-linecap="round"/>
                                <path d="M32 30 Q40 24 48 30" stroke="white" stroke-width="4" fill="none" stroke-linecap="round"/>
                                <!-- 小嘴 -->
                                <ellipse cx="30" cy="42" rx="3" ry="2" fill="#d4707a"/>
                                <!-- 气泡 -->
                                <circle cx="52" cy="8" r="7" fill="white" stroke="#1a1520" stroke-width="1"/>
                                <circle cx="50" cy="7" r="1.5" fill="#1a1520"/>
                                <circle cx="54" cy="7" r="1.5" fill="#1a1520"/>
                                <path d="M48 9 Q50 11 52 9" stroke="#1a1520" stroke-width="1" fill="none"/>
                            </svg>
                        </div>
                        <span class="app-name">メッセージ</span>
                        <span class="notification-badge">3</span>
                    </div>

                    <!-- 日记：沉思向下看的黑猫头 -->
                    <div class="app-icon" data-app="diary">
                        <div class="cat-icon">
                            <svg viewBox="0 0 60 60" fill="#1a1520">
                                <!-- 猫头轮廓 -->
                                <path d="M30 52 C12 52 4 40 4 28 C4 20 8 14 12 10 L18 2 L24 14 C26 13.5 28 13.2 30 13.2 C32 13.2 34 13.5 36 14 L42 2 L48 10 C52 14 56 20 56 28 C56 40 48 52 30 52 Z"/>
                                <!-- 左耳内 -->
                                <path d="M14 12 L18 6 L21 14 Z" fill="#c8d8e8"/>
                                <!-- 右耳内 -->
                                <path d="M46 12 L42 6 L39 14 Z" fill="#c8d8e8"/>
                                <!-- 左眼白 -->
                                <ellipse cx="20" cy="30" rx="8" ry="9" fill="white"/>
                                <!-- 右眼白 -->
                                <ellipse cx="40" cy="30" rx="8" ry="9" fill="white"/>
                                <!-- 左眼珠 - 向下看 -->
                                <circle cx="20" cy="34" r="5" fill="#1a1520"/>
                                <!-- 右眼珠 - 向下看 -->
                                <circle cx="40" cy="34" r="5" fill="#1a1520"/>
                                <!-- 眼睛高光 -->
                                <circle cx="18" cy="32" r="2" fill="white"/>
                                <circle cx="38" cy="32" r="2" fill="white"/>
                                <!-- 书本标记 -->
                                <rect x="22" y="44" width="16" height="3" rx="1" fill="#c8d8e8"/>
                                <line x1="30" y1="44" x2="30" y2="47" stroke="#1a1520" stroke-width="1"/>
                            </svg>
                        </div>
                        <span class="app-name">日記</span>
                    </div>

                    <!-- 备忘录：歪头的黑猫头 -->
                    <div class="app-icon" data-app="memo">
                        <div class="cat-icon">
                            <svg viewBox="0 0 60 60" fill="#1a1520">
                                <!-- 猫头轮廓 - 微微歪头 -->
                                <path d="M30 52 C12 52 4 40 4 28 C4 20 8 14 12 10 L18 2 L24 14 C26 13.5 28 13.2 30 13.2 C32 13.2 34 13.5 36 14 L42 2 L48 10 C52 14 56 20 56 28 C56 40 48 52 30 52 Z" transform="rotate(-5 30 30)"/>
                                <!-- 左耳内 -->
                                <path d="M14 12 L18 6 L21 14 Z" fill="#e0dcd4" transform="rotate(-5 30 30)"/>
                                <!-- 右耳内 -->
                                <path d="M46 12 L42 6 L39 14 Z" fill="#e0dcd4" transform="rotate(-5 30 30)"/>
                                <!-- 左眼白 -->
                                <ellipse cx="20" cy="30" rx="8" ry="9" fill="white" transform="rotate(-5 30 30)"/>
                                <!-- 右眼白 -->
                                <ellipse cx="40" cy="30" rx="8" ry="9" fill="white" transform="rotate(-5 30 30)"/>
                                <!-- 左眼珠 -->
                                <circle cx="22" cy="31" r="5" fill="#1a1520" transform="rotate(-5 30 30)"/>
                                <!-- 右眼珠 -->
                                <circle cx="42" cy="31" r="5" fill="#1a1520" transform="rotate(-5 30 30)"/>
                                <!-- 眼睛高光 -->
                                <circle cx="19" cy="28" r="2" fill="white" transform="rotate(-5 30 30)"/>
                                <circle cx="39" cy="28" r="2" fill="white" transform="rotate(-5 30 30)"/>
                                <!-- 铅笔 -->
                                <rect x="48" y="2" width="4" height="18" rx="1" fill="#e8945a" transform="rotate(20 50 10)"/>
                                <path d="M52 20 L54 26 L50 26 Z" fill="#f5d4c8" transform="rotate(20 50 10)"/>
                            </svg>
                        </div>
                        <span class="app-name">メモ</span>
                    </div>

                    <!-- 浏览器：好奇大眼黑猫头 -->
                    <div class="app-icon" data-app="browser">
                        <div class="cat-icon">
                            <svg viewBox="0 0 60 60" fill="#1a1520">
                                <!-- 猫头轮廓 -->
                                <path d="M30 52 C12 52 4 40 4 28 C4 20 8 14 12 10 L18 2 L24 14 C26 13.5 28 13.2 30 13.2 C32 13.2 34 13.5 36 14 L42 2 L48 10 C52 14 56 20 56 28 C56 40 48 52 30 52 Z"/>
                                <!-- 左耳内 -->
                                <path d="M14 12 L18 6 L21 14 Z" fill="#d4d0e0"/>
                                <!-- 右耳内 -->
                                <path d="M46 12 L42 6 L39 14 Z" fill="#d4d0e0"/>
                                <!-- 左眼白 - 更大更圆 -->
                                <ellipse cx="20" cy="28" rx="10" ry="11" fill="white"/>
                                <!-- 右眼白 - 更大更圆 -->
                                <ellipse cx="40" cy="28" rx="10" ry="11" fill="white"/>
                                <!-- 左眼珠 -->
                                <circle cx="22" cy="30" r="6" fill="#1a1520"/>
                                <!-- 右眼珠 -->
                                <circle cx="42" cy="30" r="6" fill="#1a1520"/>
                                <!-- 眼睛高光 - 大 -->
                                <circle cx="19" cy="26" r="3" fill="white"/>
                                <circle cx="39" cy="26" r="3" fill="white"/>
                                <!-- 小地球 -->
                                <circle cx="50" cy="50" r="8" fill="none" stroke="#8b6b8a" stroke-width="2"/>
                                <ellipse cx="50" cy="50" rx="8" ry="3" fill="none" stroke="#8b6b8a" stroke-width="1.5"/>
                                <line x1="50" y1="42" x2="50" y2="58" stroke="#8b6b8a" stroke-width="1.5"/>
                            </svg>
                        </div>
                        <span class="app-name">ブラウザ</span>
                    </div>

                    <!-- 日历：普通表情黑猫头+日历角标 -->
                    <div class="app-icon" data-app="calendar">
                        <div class="cat-icon">
                            <svg viewBox="0 0 60 60" fill="#1a1520">
                                <!-- 猫头轮廓 -->
                                <path d="M30 52 C12 52 4 40 4 28 C4 20 8 14 12 10 L18 2 L24 14 C26 13.5 28 13.2 30 13.2 C32 13.2 34 13.5 36 14 L42 2 L48 10 C52 14 56 20 56 28 C56 40 48 52 30 52 Z"/>
                                <!-- 左耳内 -->
                                <path d="M14 12 L18 6 L21 14 Z" fill="#f0e0c8"/>
                                <!-- 右耳内 -->
                                <path d="M46 12 L42 6 L39 14 Z" fill="#f0e0c8"/>
                                <!-- 左眼白 -->
                                <ellipse cx="20" cy="30" rx="8" ry="9" fill="white"/>
                                <!-- 右眼白 -->
                                <ellipse cx="40" cy="30" rx="8" ry="9" fill="white"/>
                                <!-- 左眼珠 -->
                                <circle cx="22" cy="31" r="5" fill="#1a1520"/>
                                <!-- 右眼珠 -->
                                <circle cx="42" cy="31" r="5" fill="#1a1520"/>
                                <!-- 眼睛高光 -->
                                <circle cx="19" cy="28" r="2" fill="white"/>
                                <circle cx="39" cy="28" r="2" fill="white"/>
                                <!-- 日历角标 -->
                                <rect x="42" y="42" width="16" height="14" rx="2" fill="white" stroke="#c9a86c" stroke-width="2"/>
                                <rect x="42" y="42" width="16" height="5" rx="2" fill="#c9a86c"/>
                                <text x="50" y="54" font-size="9" font-weight="bold" text-anchor="middle" fill="#1a1520">25</text>
                            </svg>
                        </div>
                        <span class="app-name">カレンダー</span>
                    </div>
                </div>
            </div>

            <!-- App页面容器 -->
            <div class="app-view" id="app-view">
                <div class="app-header">
                    <button class="back-btn" id="back-btn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                        </svg>
                    </button>
                    <span class="app-title" id="app-title"></span>
                </div>
                <div class="app-content" id="app-content"></div>
            </div>

            <!-- iPhone风格底部横条 -->
            <div class="home-bar"></div>
        </div>
    </div>

    <script>
        // ========================================
        // TELL ME WHY - マツエの携帯
        // ========================================

        const APP_CONFIG = {
            player: { title: 'プレイヤー' },
            messages: { title: 'メッセージ' },
            diary: { title: '日記' },
            memo: { title: 'メモ' },
            browser: { title: 'ブラウザ' },
            calendar: { title: 'カレンダー' }
        };

        const APP_PLACEHOLDERS = {
            player: `<div class="app-placeholder">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/></svg>
                <p>音声プレイヤー<br>準備中...</p>
            </div>`,
            messages: `<div class="app-placeholder">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/></svg>
                <p>メッセージ<br>準備中...</p>
            </div>`,
            diary: `<div class="app-placeholder">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>
                <p>日記<br>準備中...</p>
            </div>`,
            memo: `<div class="app-placeholder">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                <p>メモ<br>準備中...</p>
            </div>`,
            browser: `<div class="app-placeholder">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                <p>ブラウザ<br>準備中...</p>
            </div>`,
            calendar: `<div class="app-placeholder">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11zM9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                <p>カレンダー<br>準備中...</p>
            </div>`
        };

        let currentApp = null;
        let homeScreen, appView, appContent, appTitle, backBtn;

        // 日记数据
        let diaryData = [];
        let diaryDataLoaded = false;
        let diaryViewState = 'list'; // 'list' or 'detail'

        document.addEventListener('DOMContentLoaded', async () => {
            homeScreen = document.getElementById('home-screen');
            appView = document.getElementById('app-view');
            appContent = document.getElementById('app-content');
            appTitle = document.getElementById('app-title');
            backBtn = document.getElementById('back-btn');

            // 预加载日记数据
            await loadDiaryData();

            // App图标点击
            document.querySelectorAll('.app-icon').forEach(icon => {
                icon.addEventListener('click', () => {
                    const appId = icon.dataset.app;
                    if (appId) openApp(appId);
                });
            });

            // 返回按钮
            backBtn.addEventListener('click', closeApp);

            // Escape键返回
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && currentApp) closeApp();
            });

            // 更新状态栏时间
            updateStatusTime();
            setInterval(updateStatusTime, 1000);
        });

        async function openApp(appId) {
            if (!APP_CONFIG[appId]) return;
            currentApp = appId;
            appTitle.textContent = APP_CONFIG[appId].title;

            // 根据不同app渲染不同内容
            if (appId === 'diary') {
                // 确保数据已加载
                if (!diaryDataLoaded) {
                    await loadDiaryData();
                }
                appContent.innerHTML = renderDiaryList();
            } else {
                appContent.innerHTML = APP_PLACEHOLDERS[appId] || '<div class="app-placeholder"><p>Unknown App</p></div>';
            }

            homeScreen.classList.remove('active');
            appView.classList.add('active');
        }

        function closeApp() {
            currentApp = null;
            appView.classList.remove('active');
            homeScreen.classList.add('active');
            setTimeout(() => { appContent.innerHTML = ''; }, 400);
        }

        function updateStatusTime() {
            const timeEl = document.getElementById('status-time');
            if (timeEl) {
                const now = new Date();
                timeEl.textContent = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            }
        }

        // ========================================
        // 日記 App
        // ========================================

        async function loadDiaryData() {
            try {
                const response = await fetch('data/diary.json');
                const data = await response.json();
                diaryData = data.entries || [];
                diaryDataLoaded = true;
                console.log('Diary data loaded:', diaryData.length, 'entries');
            } catch (e) {
                console.error('Failed to load diary data:', e);
                diaryData = [];
                diaryDataLoaded = false;
            }
        }

        function renderDiaryList() {
            diaryViewState = 'list';
            if (diaryData.length === 0) {
                return `<div class="app-placeholder">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>
                    <p>日記を読み込み中...</p>
                </div>`;
            }

            let html = '<div class="diary-list">';
            diaryData.forEach((entry, index) => {
                // 获取第一段作为预览
                const preview = entry.content[0]?.zh || '';
                html += `
                    <div class="diary-entry" data-diary-id="${entry.id}" onclick="openDiaryDetail(${entry.id})">
                        <div class="diary-number">ENTRY ${String(entry.id).padStart(2, '0')}</div>
                        <div class="diary-title">${entry.title}</div>
                        <div class="diary-preview">${preview}</div>
                    </div>
                `;
            });
            html += '</div>';
            return html;
        }

        function openDiaryDetail(id) {
            const entry = diaryData.find(d => d.id === id);
            if (!entry) return;

            diaryViewState = 'detail';

            let html = `
                <div class="diary-detail">
                    <button class="diary-back" onclick="backToDiaryList()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                        </svg>
                        一覧に戻る
                    </button>
                    <div class="diary-detail-header">
                        <div class="diary-detail-number">ENTRY ${String(entry.id).padStart(2, '0')}</div>
                        <div class="diary-detail-title">${entry.title}</div>
                    </div>
                    <div class="diary-content">
            `;

            entry.content.forEach(para => {
                html += `
                    <div class="diary-paragraph">
                        <div class="diary-ja">${para.ja}</div>
                        <div class="diary-zh">${para.zh}</div>
                    </div>
                `;
            });

            html += '</div></div>';
            appContent.innerHTML = html;
        }

        function backToDiaryList() {
            diaryViewState = 'list';
            appContent.innerHTML = renderDiaryList();
        }
    </script>
</body>
</html>
